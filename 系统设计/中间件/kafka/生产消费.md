# Kafka：生产消费者

# **消费者组**

**消费者**：负责**订阅**Kafka中的Topic并从中**拉取**消息，consumer一般为某个独立进程实例

> Kafka的消费理念中，还有一层消费组（Consumer Group）的概念，**每一个消费者都对应的一个消费组**

**消费组**：kafka用于实现`单播`和`广播`两种消息模型的手段，同一个topic，每个消费者组都可以拿到相同的全部数据

消费者组内包含多个consumer实例，每个实例通过重均衡机制，**协调订阅**topic下的所有分区。一个分区只能由同一个消费组中的一个consumer消费，分区可被多个组的固定consumer消费

示例：
- 组内consumer数量 > partition数：多余consumer处于空闲状态，**确保每个分区只被同一个组内单个消费者消费**

- 组内consumer数量 <= partition数：当分区数等于消费者数时，每个消费者对应一个分区；当分区数大于消费者数时，有的消费者对应多个分区

- 多个消费者组：相同的数据会被不同组的消费者**消费多次**

传统消息系统中，有两种消息模型：点对点模型（`传统消息队列`）、发布/订阅模型

- 点对点：消息一旦被消费，就会从队列中删除，而且**只能被下游的一个**consumer消费

    伸缩性差：

    - 只能被下游的一个consumer消费，无法

    - 多个consumer从共享队列中取出消费，引入资源竞争可能有锁资源等方式的开销

- 发布/订阅：允许消息被多个订阅者消费

    > 伸缩性差：


# 参考
- [Kafka消费者组是什么？](https://blog.csdn.net/qq_36918149/article/details/99656156)
- [消费者组和分区数对应关系测试](https://blog.csdn.net/gdkyxy2013/article/details/86644919)

- [kafka在高并发的情况下,如何避免消息丢失和消息重复?](https://www.cnblogs.com/williamwucoder/p/13347934.html)