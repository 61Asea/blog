# Redis类型键：set

## **编码方式**

集合对象的编码可以是`REDIS_ENCODING_INTSET`或者`REDIS_ENCODING_SKIPLIST`，这句话等价于：列表对象的底层实现可以是`intset`或者`hashtable`

- 当使用intset作为set键的底层结构时，集合元素存储在`contents[]`数组中

    contents会根据整型元素的大小，适时地升级，将contents的类型变为更大的整型，以在不必要时节省内存

    > 一旦升级完成，将无法降级

- 当使用hashtable作为set键的底层结构时，**只使用了hashtable中的keyset**

    字典中的每个键都是一个字符串对象，这个字符串对象包含了集合的各个元素值，然后将字典的值全部设置为NULL

## **编码转换**

当集合对象同时满足以下两个条件时，对象使用intset编码：

- 集合对象的元素不超过512个

- 集合对象保存的所有元素都是整数

## **API**

`SPOP`：**随机**取出一个元素，再将其从集合中删除

> 这个方法容易产生误解，会让人以为集合的队尾元素出队，注意：集合是`无序`的，根本没有**队头队尾**的概念

# 参考
- [Redis设计与实现]()